# راهنمای مشارکت در پروژه

با تشکر از علاقه شما به مشارکت در پروژه سیستم پایش توییتر. این سند راهنمایی برای افرادی است که می‌خواهند در توسعه پروژه مشارکت کنند.

## فرآیند مشارکت

1. **Fork کردن مخزن**: ابتدا مخزن اصلی را fork کنید.
2. **کلون کردن**: مخزن fork شده را به صورت محلی کلون کنید.
3. **ایجاد شاخه**: یک شاخه جدید برای تغییرات خود ایجاد کنید.
4. **اعمال تغییرات**: تغییرات مورد نظر را اعمال کنید.
5. **اجرای تست‌ها**: مطمئن شوید همه تست‌ها با موفقیت اجرا می‌شوند.
6. **Commit و Push**: تغییرات را commit کرده و به مخزن fork شده خود push کنید.
7. **درخواست Pull Request**: یک pull request به مخزن اصلی ارسال کنید.

## استانداردهای کدنویسی

ما از استانداردهای زیر برای کدنویسی استفاده می‌کنیم:

### پایتون

- **PEP 8**: استاندارد نگارش کد پایتون
- **Black**: فرمتر خودکار کد پایتون
- **isort**: مرتب‌سازی import‌ها
- **flake8**: لینتر کد پایتون
- **mypy**: بررسی استاتیک تایپ‌ها

### نام‌گذاری

- **ماژول‌ها و پکیج‌ها**: snake_case (مانند `twitter_service.py`)
- **کلاس‌ها**: PascalCase (مانند `TweetService`)
- **متدها و توابع**: snake_case (مانند `extract_tweets()`)
- **متغیرها**: snake_case (مانند `tweet_count`)
- **ثابت‌ها**: UPPER_CASE (مانند `MAX_TWEETS_PER_REQUEST`)

### ساختار کد

- از docstring برای مستندسازی کلاس‌ها، توابع و ماژول‌ها استفاده کنید.
- از type hints پایتون برای مشخص کردن نوع پارامترها و مقدار بازگشتی استفاده کنید.
- استثناءهای مناسب تعریف کنید و خطاها را به درستی مدیریت کنید.
- از الگوهای طراحی مناسب مانند Dependency Injection استفاده کنید.

## اضافه کردن ویژگی‌های جدید

1. قبل از شروع توسعه، ایده خود را در قالب یک issue مطرح کنید.
2. پس از تأیید، یک شاخه جدید برای ویژگی ایجاد کنید.
3. تست‌های مناسب برای ویژگی جدید بنویسید.
4. ویژگی را پیاده‌سازی کنید.
5. تست‌ها را اجرا کنید و مطمئن شوید همه تست‌ها با موفقیت اجرا می‌شوند.
6. تغییرات را commit کرده و یک pull request ایجاد کنید.

### نام‌گذاری شاخه‌ها

- `feature/`: برای ویژگی‌های جدید (مانند `feature/sentiment-analysis`)
- `bugfix/`: برای رفع اشکالات (مانند `bugfix/extraction-timeout`)
- `improvement/`: برای بهبودهای کلی (مانند `improvement/error-handling`)
- `docs/`: برای تغییرات مستندات (مانند `docs/api-documentation`)

## معماری پروژه

پروژه از یک معماری لایه‌بندی شده پیروی می‌کند:

1. **لایه API**: مسئول مدیریت درخواست‌ها و پاسخ‌ها (`app/api`)
2. **لایه سرویس**: منطق کسب‌وکار برنامه (`app/services`)
3. **لایه مدل**: نمایش داده‌ها و ارتباط با دیتابیس (`app/models`)
4. **لایه هسته**: قابلیت‌های مرکزی و زیرساختی (`app/core`)

### قواعد وابستگی

- لایه API می‌تواند به همه لایه‌ها وابستگی داشته باشد.
- لایه سرویس می‌تواند به لایه مدل و هسته وابستگی داشته باشد، اما نه به لایه API.
- لایه مدل می‌تواند فقط به لایه هسته وابستگی داشته باشد.
- لایه هسته نباید به هیچ لایه دیگری وابستگی داشته باشد.

## اجرای تست‌ها

برای اطمینان از کیفیت کد، همه تغییرات باید توسط تست‌ها پوشش داده شوند. برای اجرای تست‌ها:

```bash
./run_tests.sh        # اجرای همه تست‌ها
./run_tests.sh --coverage  # اجرای تست‌ها با گزارش پوشش کد
```

ما حداقل 80% پوشش کد برای هر ماژول جدید را الزامی می‌دانیم.

## بررسی کیفیت کد

قبل از ارسال pull request، کیفیت کد خود را بررسی کنید:

```bash
./lint.sh          # بررسی کیفیت کد
./lint.sh --fix    # اصلاح خودکار مشکلات قابل رفع
```

## مهاجرت‌های پایگاه داده

اگر تغییرات شما نیاز به تغییر ساختار دیتابیس دارد، یک فایل میگریشن جدید در `backend/app/migrations` ایجاد کنید:

```python
from app.core.migrations import Migration

class MyNewMigration(Migration):
    version = "002"  # شماره نسخه باید منحصر به فرد باشد
    description = "توضیح مختصر درباره میگریشن"
    
    async def up(self):
        """اجرای میگریشن"""
        # کد میگریشن
    
    async def down(self):
        """برگشت میگریشن"""
        # کد برگشت میگریشن
```

## مستندسازی تغییرات

- هر commit باید یک پیام واضح داشته باشد که توضیح دهد چه تغییری اعمال شده است.
- تغییرات API باید در مستندات API به‌روزرسانی شوند.
- تغییرات اساسی باید در `README.md` یا مستندات مربوطه ذکر شوند.

## سوالات و کمک

اگر سوال یا مشکلی دارید، می‌توانید:

- یک issue در مخزن گیت‌هاب ایجاد کنید
- در بخش discussions پروژه سوال خود را مطرح کنید

با تشکر از مشارکت شما در پروژه!
